{
    "sourceFile": "repository/repo.go",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1691487042933,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1691499579813,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,5 +54,14 @@\n \tif result.Error != nil {\r\n \t\treturn result.Error\r\n \t}\r\n \treturn nil\r\n-}\n\\ No newline at end of file\n+}\r\n+// repository 包中的 GetPublishedVideos 函数\r\n+func (r *DbRepository) GetPublishedVideos() ([]*model.Video, error) {\r\n+\tvar videos []*model.Video\r\n+\terr := r.db.Find(&videos).Error\r\n+\tif err != nil {\r\n+\t\treturn nil, fmt.Errorf(\"Failed to get videos: %w\", err)\r\n+\t}\r\n+\treturn videos, nil\r\n+}\r\n"
                },
                {
                    "date": 1691503383387,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,14 +54,5 @@\n \tif result.Error != nil {\r\n \t\treturn result.Error\r\n \t}\r\n \treturn nil\r\n-}\r\n-// repository 包中的 GetPublishedVideos 函数\r\n-func (r *DbRepository) GetPublishedVideos() ([]*model.Video, error) {\r\n-\tvar videos []*model.Video\r\n-\terr := r.db.Find(&videos).Error\r\n-\tif err != nil {\r\n-\t\treturn nil, fmt.Errorf(\"Failed to get videos: %w\", err)\r\n-\t}\r\n-\treturn videos, nil\r\n-}\r\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1691503389615,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,67 @@\n+package repository\r\n+\r\n+import (\r\n+\t\"github.com/Coreychen4444/Users/model\"\r\n+\t\"gorm.io/gorm\"\r\n+)\r\n+\r\n+type DbRepository struct {\r\n+\tdb *gorm.DB\r\n+}\r\n+\r\n+func NewDbRepository(db *gorm.DB) *DbRepository {\r\n+\treturn &DbRepository{db: db}\r\n+}\r\n+\r\n+// 创建用户\r\n+func (r *DbRepository) CreateUsers(user *model.User) (*model.User, error) {\r\n+\tresult := r.db.Create(user)\r\n+\tif result.Error != nil {\r\n+\t\treturn nil, result.Error\r\n+\t}\r\n+\treturn user, nil\r\n+}\r\n+\r\n+// 根据用户名获取用户\r\n+func (r *DbRepository) GetUserByName(username string) (*model.User, error) {\r\n+\tvar user model.User\r\n+\terr := r.db.Where(\"username = ?\", username).First(&user).Error\r\n+\tif err != nil {\r\n+\t\tif err == gorm.ErrRecordNotFound {\r\n+\t\t\treturn nil, err\r\n+\t\t}\r\n+\t\treturn nil, err\r\n+\t}\r\n+\treturn &user, nil\r\n+}\r\n+\r\n+// 根据用户id获取用户\r\n+func (r *DbRepository) GetUserById(id int64) (*model.User, error) {\r\n+\tvar user model.User\r\n+\terr := r.db.Where(\"id = ?\", id).First(&user).Error\r\n+\tif err != nil {\r\n+\t\tif err == gorm.ErrRecordNotFound {\r\n+\t\t\treturn nil, err\r\n+\t\t}\r\n+\t\treturn nil, err\r\n+\t}\r\n+\treturn &user, nil\r\n+}\r\n+\r\n+// 创建视频记录\r\n+func (r *DbRepository) CreateVideo(video *model.Video) error {\r\n+\tresult := r.db.Create(video)\r\n+\tif result.Error != nil {\r\n+\t\treturn result.Error\r\n+\t}\r\n+\treturn nil\r\n+}\r\n+// repository 包中的 GetPublishedVideos 函数\r\n+func (r *DbRepository) GetPublishedVideos() ([]*model.Video, error) {\r\n+\tvar videos []*model.Video\r\n+\terr := r.db.Find(&videos).Error\r\n+\tif err != nil {\r\n+\t\treturn nil, fmt.Errorf(\"Failed to get videos: %w\", err)\r\n+\t}\r\n+\treturn videos, nil\r\n+}\r\n"
                },
                {
                    "date": 1691504100896,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,9 @@\n package repository\r\n \r\n import (\r\n+\t\"fmt\"\r\n+\r\n \t\"github.com/Coreychen4444/Users/model\"\r\n \t\"gorm.io/gorm\"\r\n )\r\n \r\n@@ -47,79 +49,9 @@\n \t}\r\n \treturn &user, nil\r\n }\r\n \r\n-// 创建视频记录\r\n-func (r *DbRepository) CreateVideo(video *model.Video) error {\r\n-\tresult := r.db.Create(video)\r\n-\tif result.Error != nil {\r\n-\t\treturn result.Error\r\n-\t}\r\n-\treturn nil\r\n-}\r\n-// repository 包中的 GetPublishedVideos 函数\r\n-func (r *DbRepository) GetPublishedVideos() ([]*model.Video, error) {\r\n-\tvar videos []*model.Video\r\n-\terr := r.db.Find(&videos).Error\r\n-\tif err != nil {\r\n-\t\treturn nil, fmt.Errorf(\"Failed to get videos: %w\", err)\r\n-\t}\r\n-\treturn videos, nil\r\n-}\r\n-package repository\r\n+// 根据文件扩展名创建视频记录\r\n \r\n-import (\r\n-\t\"github.com/Coreychen4444/Users/model\"\r\n-\t\"gorm.io/gorm\"\r\n-)\r\n-\r\n-type DbRepository struct {\r\n-\tdb *gorm.DB\r\n-}\r\n-\r\n-func NewDbRepository(db *gorm.DB) *DbRepository {\r\n-\treturn &DbRepository{db: db}\r\n-}\r\n-\r\n-// 创建用户\r\n-func (r *DbRepository) CreateUsers(user *model.User) (*model.User, error) {\r\n-\tresult := r.db.Create(user)\r\n-\tif result.Error != nil {\r\n-\t\treturn nil, result.Error\r\n-\t}\r\n-\treturn user, nil\r\n-}\r\n-\r\n-// 根据用户名获取用户\r\n-func (r *DbRepository) GetUserByName(username string) (*model.User, error) {\r\n-\tvar user model.User\r\n-\terr := r.db.Where(\"username = ?\", username).First(&user).Error\r\n-\tif err != nil {\r\n-\t\tif err == gorm.ErrRecordNotFound {\r\n-\t\t\treturn nil, err\r\n-\t\t}\r\n-\t\treturn nil, err\r\n-\t}\r\n-\treturn &user, nil\r\n-}\r\n-\r\n-// 根据用户id获取用户\r\n-func (r *DbRepository) GetUserById(id int64) (*model.User, error) {\r\n-\tvar user model.User\r\n-\terr := r.db.Where(\"id = ?\", id).First(&user).Error\r\n-\tif err != nil {\r\n-\t\tif err == gorm.ErrRecordNotFound {\r\n-\t\t\treturn nil, err\r\n-\t\t}\r\n-\t\treturn nil, err\r\n-\t}\r\n-\treturn &user, nil\r\n-}\r\n-\r\n-// 创建视频记录\r\n func (r *DbRepository) CreateVideo(video *model.Video) error {\r\n \tresult := r.db.Create(video)\r\n \tif result.Error != nil {\r\n-\t\treturn result.Error\r\n-\t}\r\n-\treturn nil\r\n\\ No newline at end of file\n-}\n"
                }
            ],
            "date": 1691487042933,
            "name": "Commit-0",
            "content": "package repository\r\n\r\nimport (\r\n\t\"github.com/Coreychen4444/Users/model\"\r\n\t\"gorm.io/gorm\"\r\n)\r\n\r\ntype DbRepository struct {\r\n\tdb *gorm.DB\r\n}\r\n\r\nfunc NewDbRepository(db *gorm.DB) *DbRepository {\r\n\treturn &DbRepository{db: db}\r\n}\r\n\r\n// 创建用户\r\nfunc (r *DbRepository) CreateUsers(user *model.User) (*model.User, error) {\r\n\tresult := r.db.Create(user)\r\n\tif result.Error != nil {\r\n\t\treturn nil, result.Error\r\n\t}\r\n\treturn user, nil\r\n}\r\n\r\n// 根据用户名获取用户\r\nfunc (r *DbRepository) GetUserByName(username string) (*model.User, error) {\r\n\tvar user model.User\r\n\terr := r.db.Where(\"username = ?\", username).First(&user).Error\r\n\tif err != nil {\r\n\t\tif err == gorm.ErrRecordNotFound {\r\n\t\t\treturn nil, err\r\n\t\t}\r\n\t\treturn nil, err\r\n\t}\r\n\treturn &user, nil\r\n}\r\n\r\n// 根据用户id获取用户\r\nfunc (r *DbRepository) GetUserById(id int64) (*model.User, error) {\r\n\tvar user model.User\r\n\terr := r.db.Where(\"id = ?\", id).First(&user).Error\r\n\tif err != nil {\r\n\t\tif err == gorm.ErrRecordNotFound {\r\n\t\t\treturn nil, err\r\n\t\t}\r\n\t\treturn nil, err\r\n\t}\r\n\treturn &user, nil\r\n}\r\n\r\n// 创建视频记录\r\nfunc (r *DbRepository) CreateVideo(video *model.Video) error {\r\n\tresult := r.db.Create(video)\r\n\tif result.Error != nil {\r\n\t\treturn result.Error\r\n\t}\r\n\treturn nil\r\n}"
        }
    ]
}